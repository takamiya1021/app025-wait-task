# app025: レンダリング待ちタスク管理 - 要件定義書

## 1. アプリ概要
AI生成・レンダリング等の待ち時間に「この間にやっとくチェックリスト」をポップアップ表示し、隙間時間を有効活用するタスク管理アプリ。

## 2. 目的・課題

### 解決する課題
- AI画像生成の待ち時間（数十秒〜数分）をボーッと待ってしまう
- 動画レンダリング中に何をすればいいか分からない
- 短い隙間時間を有効活用できていない
- タスクを思い出すのに時間がかかる
- 待ち時間の積み重ねが無駄になっている

### 目的
- 待ち時間を検出して自動的にタスクリストを表示
- 短時間で完了するタスクを提案
- 隙間時間の有効活用を習慣化
- 生産性の向上

## 3. ターゲットユーザー
- AI画像生成ユーザー
- 動画編集者（レンダリング待ち）
- 3DCGクリエイター（レンダリング待ち）
- プログラマー（コンパイル・ビルド待ち）
- 効率的に時間を使いたい全ユーザー

## 4. 機能要件

### 4.1 必須機能（MVP）
- **タスクリスト管理**
  - タスクの追加・編集・削除
  - チェックボックスで完了管理
  - タスクの優先度設定（高/中/低）
  - 所要時間の設定（1分/3分/5分/10分）

- **待ち時間検出**
  - タイマー機能（手動開始）
  - カウントダウン表示
  - 終了時の通知（音・ビジュアル）

- **タスク提案**
  - 設定した待ち時間に応じて適切なタスクを表示
  - 所要時間フィルター（例: 5分以内のタスクのみ）
  - 優先度順に並び替え

- **ポップアップ表示**
  - タイマー開始時に自動的にタスクリストをポップアップ
  - 常に最前面表示（オプション）
  - 閉じるボタン、最小化機能

### 4.2 拡張機能（優先度：中）
- **自動検出機能**
  - 特定のアプリケーション起動を検出（将来的な拡張）
  - CPU/GPU使用率から待ち時間を推測

- **統計機能**
  - 隙間時間の合計表示
  - 完了タスク数のカウント
  - 生産性レポート（週次・月次）

- **カテゴリー機能**
  - タスクをカテゴリー分け（仕事/私用/学習等）
  - カテゴリー別フィルター

- **繰り返しタスク**
  - 毎日のルーティンタスク
  - 定期的に表示されるリマインダー

### 4.3 将来的な拡張（優先度：低）
- 外部カレンダー連携
- Notion/Trello等のタスク管理ツール連携
- スマホアプリ版（通知連携）

### 4.4 AI機能（Gemini API）
- **最適タスク提案**
  - 待ち時間の長さを分析
  - 過去の完了パターンから最適なタスクを提案
  - 優先度と所要時間を考慮した推薦

- **タスク自動分類**
  - 入力したタスクを自動的にカテゴリー分け（仕事/私用/学習/雑務等）
  - 所要時間の自動推定
  - 優先度の自動判定

- **タスク自動生成**
  - ユーザーの作業パターンを学習
  - 「この時間帯によくやるタスク」を自動提案
  - 定期タスクの自動追加提案

- **生産性アドバイス**
  - 隙間時間の活用状況を分析
  - 完了率・達成パターンからアドバイス
  - 「このカテゴリーのタスクを増やすと効率的」等の提案

- **タスク粒度の最適化**
  - タスクが大きすぎる/小さすぎる場合に検出
  - 適切な粒度への分割・統合を提案

## 5. 非機能要件

### 5.1 パフォーマンス
- タイマー精度 ±1秒以内
- ポップアップ表示の遅延 < 100ms
- 100タスクまでスムーズに動作

### 5.2 ユーザビリティ
- ワンクリックでタイマー開始
- 直感的なタスク追加UI
- キーボードショートカット対応

### 5.3 データ管理
- LocalStorageでタスクデータを保存
- タスク完了履歴の保持
- データのバックアップ/復元

## 6. 技術制約

### 6.1 環境要件
- モダンブラウザ対応
- デスクトップ優先（通知API使用）
- レスポンシブ対応（タブレット可）

### 6.2 通知機能
- Web Notifications API使用
- ブラウザ通知の許可取得
- 音声通知（オプション）

### 6.3 データ制約
- LocalStorage使用
- タスク履歴は直近30日分保持

### 6.4 AI API仕様
- **使用API**: Google Gemini API
  - モデル: gemini-2.0-flash-exp
  - エンドポイント: Google AI Studio API

- **APIキー管理**
  - 保存場所: LocalStorage
  - 保存形式: 平文（暗号化なし）
  - キー名: `gemini_api_key`
  - 設定UI: アプリ内設定画面で登録・変更可能

- **起動時チェック**
  - APIキー未登録時は設定画面を表示
  - APIキー検証（簡易的な接続テスト）
  - エラーハンドリング（APIキー無効時の対応）

- **AI機能の利用**
  - AI機能はオプション（APIキーなしでも基本機能は利用可能）
  - API呼び出しエラー時の適切なフィードバック
  - レート制限への対応

## 7. 成功基準

### 7.1 機能面
- ✅ タイマー開始でタスクリストがポップアップ
- ✅ 所要時間に応じたタスクフィルタリングが動作
- ✅ タスク完了のチェック・保存が正常動作
- ✅ 通知機能が適切に動作

### 7.2 UX面
- ✅ タイマー開始が1クリックで完了
- ✅ タスク追加が10秒以内に完了
- ✅ ポップアップが邪魔にならない

### 7.3 技術面
- ✅ タイマーの精度が高い
- ✅ データ永続化が安定
- ✅ 通知が確実に表示される

## 8. 制約事項・前提条件

### 8.1 制約事項
- 自動検出機能はPhase 2以降
- スマホアプリ版は対象外（Phase 1）
- タスク管理ツール連携は対象外（Phase 1）

### 8.2 前提条件
- ユーザーがタスクを事前に登録
- Web Notifications API対応ブラウザ
- 通知許可を付与

## 9. UI/UX要求

### 9.1 デザイン方向性
- シンプルで視認性の高いデザイン
- 邪魔にならないポップアップサイズ
- 完了時の達成感を演出（アニメーション）

### 9.2 主要画面
1. **メイン画面**（タスク管理）
   - ヘッダー: アプリ名、タイマー開始ボタン
   - タスク追加フォーム
   - タスクリスト（チェックボックス、タスク名、所要時間、優先度、削除ボタン）
   - フィルターエリア: カテゴリー、所要時間、優先度

2. **タイマー設定画面**
   - 待ち時間入力（分単位）
   - プリセット: 1分/3分/5分/10分/15分
   - タイマー開始ボタン
   - 表示するタスクのフィルター設定

3. **ポップアップウィンドウ**
   - 上部: 残り時間カウントダウン、進行状況バー
   - 中央: タスクリスト（所要時間フィルター済み）
   - 下部: 閉じるボタン、最小化ボタン
   - サイズ: 400x600px程度（調整可能）

4. **統計画面**（Phase 2）
   - 今週の隙間時間合計
   - 完了タスク数
   - カテゴリー別内訳
   - 生産性グラフ

## 10. スケジュール・優先度

### Phase 1（MVP）
- タスクリスト管理
- タイマー機能
- ポップアップ表示
- 所要時間フィルター

### Phase 2（拡張）
- カテゴリー機能
- 統計機能
- 繰り返しタスク

### Phase 3（改善）
- 自動検出機能（研究）
- UI/UXブラッシュアップ
- パフォーマンス最適化

## 11. タイマー動作フロー

```
1. ユーザーが待ち時間を設定（例: 5分）
2. タイマー開始ボタンをクリック
3. ポップアップウィンドウが表示される
   - 5分以内に完了するタスクのみを表示
   - カウントダウン開始
4. ユーザーがタスクを実行しながらチェック
5. タイマー終了時
   - 音・通知で知らせる
   - 完了タスク数を記録
   - ポップアップを自動的に閉じる（オプション）
```

## 12. データ構造（初期案）

```json
{
  "tasks": [
    {
      "id": "task_001",
      "title": "メールチェック",
      "duration": 3,
      "priority": "medium",
      "category": "work",
      "completed": false,
      "createdAt": "2025-01-01T00:00:00Z"
    }
  ],
  "history": [
    {
      "date": "2025-01-01",
      "totalTime": 15,
      "completedTasks": 3
    }
  ],
  "settings": {
    "notificationSound": true,
    "alwaysOnTop": true,
    "defaultDuration": 5
  }
}
```

## 13. 通知例

- **タイマー終了時**: "⏰ 待ち時間が終了しました！3つのタスクを完了しました 🎉"
- **タイマー残り1分**: "⏱️ あと1分です。最後のタスクをチェックしましょう！"
